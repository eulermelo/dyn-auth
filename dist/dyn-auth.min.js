!function(){"use strict";angular.module("dyn.auth",["ngCookies"])}(),function(){"use strict";function t(t){function n(n,r,o){n.currentUser=t.getCurrentUser(),n.$watch("currentUser",function(){var n=o.dynAccessControl.split(",");t.hasSomeRole(n)||r.remove()})}return{restrict:"A",link:n}}angular.module("dyn.auth").directive("dynAccessControl",t),t.$inject=["dynAuth"]}(),function(){"use strict";function t(t,n,r,o){return{request:function(n){return n.headers=n.headers||{},t.localStorage.token&&(n.headers.Authorization=t.localStorage.token),n},responseError:function(t){return 401===t.status?o.$broadcast("dynAuth.userUnauthorized",{urlToRedirect:r.loginUrl}):403===t.status?o.$broadcast("dynAuth.forbbiden"):500===t.status&&o.$broadcast("dynAuth.internalServerError"),n.reject(t)}}}function n(t){t.interceptors.push("dynAuthInterceptor")}angular.module("dyn.auth").factory("dynAuthInterceptor",t).config(n),t.$inject=["$window","$q","dynAuthConfig","$rootScope"],n.$inject=["$httpProvider"]}(),function(){"use strict";function t(t,r,o,e,u,a,i,c){function l(){return o.post(c.logoutUrl).then(function(t){delete r.localStorage.token,delete r.localStorage.currentUserStr,a.remove("Authorization"),n={};var o=t.data||{url:f()};return S(v,o),o})}function s(){var t=U(),r=angular.equals({},n)||!n;return t&&!r}function d(){return s()?n:void 0}function f(){return c.loginUrl||{}}function h(t){return(!n||n.roles instanceof Array)&&(s()&&n.roles.some(function(n){return n===t}))}function g(t){return t instanceof Array?t.some(function(t){return h(t.trim())}):(i.warn("[hasSomeRole] o parametro passado não é um Array"),!1)}function A(){var n=U();return t(function(t,r){n&&t($(c.homeLocation)),r($(c.loginUrl))})}function U(){var t=r.localStorage.currentUserStr,o=r.localStorage.token,e=angular.copy(a.get("Authorization"));return t&&o&&o===e?(n=JSON.parse(t),!0):!!e&&(r.localStorage.token=e,!0)}function y(){return r.localStorage.token?o.get(c.userInfoUrl).then(function(t){return n=t.data||{},r.localStorage.currentUserStr=JSON.stringify(n),S(m),$(c.homeLocation)})["catch"](function(t){return S(C),C}):t(function(t,n){n($(c.loginUrl))})}function S(t,n){u.$broadcast(t,n)}function $(t){return{urlToRedirect:t}}var m="dynAuth.userChanged",p="dynAuth.userUnauthorized",v="dynAuth.userLoggedOut",C="dynAuth.userLoadInfoFailed";return{AUTH_USER_CHANGED:m,AUTH_USER_UNAUTHORIZED:p,AUTH_USER_LOGGED_OUT:v,AUTH_USER_LOAD_INFO_FAILED:C,logout:l,getCurrentUser:d,isLoggedIn:s,hasRole:h,hasSomeRole:g,getUrlLogin:f,hasValidCredentials:A,loadUserInfos:y}}angular.module("dyn.auth").factory("dynAuth",t);var n=null;t.$inject=["$q","$window","$http","$location","$rootScope","$cookies","$log","dynAuthConfig"]}(),function(){"use strict";function t(){this.config={homeLocation:"/home",loginUrl:"/idp",logoutUrl:"/idp/logout",userInfoUrl:"/idp/auth/me"},this.$get=function(){return this.config}}angular.module("dyn.auth").provider("dynAuthConfig",t),t.$inject=[]}();