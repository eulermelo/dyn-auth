!function(){"use strict";angular.module("dyn.auth",["ngCookies"])}(),function(){"use strict";function t(t){function n(n,r,o){n.currentUser=t.getCurrentUser(),n.$watch("currentUser",function(){var n=o.dynHasProfile.split(",");t.hasSomeProfile(n)||r.remove()})}return{restrict:"A",link:n}}angular.module("dyn.auth").directive("dynHasProfile",t),t.$inject=["dynAuth"]}(),function(){"use strict";function t(t,n,r,o){return{request:function(n){return n.headers=n.headers||{},t.localStorage.token&&(n.headers.Authorization=t.localStorage.token),n},responseError:function(t){return 401===t.status?o.$broadcast("dynAuth.userUnauthorized",{urlToRedirect:r.loginUrl}):403===t.status?o.$broadcast("dynAuth.forbbiden"):500===t.status&&o.$broadcast("dynAuth.internalServerError"),n.reject(t)}}}function n(t){t.interceptors.push("dynAuthInterceptor")}angular.module("dyn.auth").factory("dynAuthInterceptor",t).config(n),t.$inject=["$window","$q","dynAuthConfig","$rootScope"],n.$inject=["$httpProvider"]}(),function(){"use strict";function t(t,r,o,e,u,i,a,c){function s(){return o.post(c.logoutUrl).then(function(t){delete r.localStorage.token,delete r.localStorage.currentUserStr,i.remove("Authorization"),n={};var o=t.data||{url:f()};return $(E,o),o})}function l(){var t=p(),r=angular.equals({},n)||!n;return t&&!r}function d(){return l()?n:void 0}function f(){return c.loginUrl||{}}function h(t){return(!n||n.profiles instanceof Array)&&(l()&&n.profiles.some(function(n){return n===t}))}function g(t){return t instanceof Array?t.some(function(t){return h(t.trim())}):(a.warn("[hasSomeProfile] o parametro passado não é um Array"),!1)}function U(){var n=p();return t(function(t,r){n&&t(m(c.homeLocation)),r(m(c.loginUrl))})}function p(){var t=r.localStorage.currentUserStr,o=r.localStorage.token,e=angular.copy(i.get("Authorization"));return t&&o&&o===e?(n=JSON.parse(t),!0):!!e&&(r.localStorage.token=e,!0)}function A(){return r.localStorage.token?o.get(c.userInfoUrl).then(function(t){return n=t.data||{},r.localStorage.currentUserStr=JSON.stringify(n),$(v),m(c.homeLocation)})["catch"](function(t){return $(I),I}):t(function(t,n){n(m(c.loginUrl))})}function S(){return o.post(c.updateSessionUrl).then(function(t){return t.data})["catch"](function(t){return $(z),z})}function y(t){return o.post(c.authorizeApplicationUrl,t).then(function(t){return t.data})}function $(t,n){u.$broadcast(t,n)}function m(t){return{urlToRedirect:t}}var v="dynAuth.userChanged",_="dynAuth.userUnauthorized",E="dynAuth.userLoggedOut",I="dynAuth.userLoadInfoFailed",z="dynAuth.ssoUnauthorized";return{AUTH_USER_CHANGED:v,AUTH_USER_UNAUTHORIZED:_,AUTH_USER_LOGGED_OUT:E,AUTH_USER_LOAD_INFO_FAILED:I,AUTH_USER_SSO_UNAUTHORIZED:z,logout:s,getCurrentUser:d,isLoggedIn:l,hasProfile:h,hasSomeProfile:g,getUrlLogin:f,hasValidCredentials:U,loadUserInfos:A,updateSession:S,authorizeApplication:y}}angular.module("dyn.auth").factory("dynAuth",t);var n=null;t.$inject=["$q","$window","$http","$location","$rootScope","$cookies","$log","dynAuthConfig"]}(),function(){"use strict";function t(){this.config={homeLocation:"/home",loginUrl:"/idp",logoutUrl:"/idp/logout",userInfoUrl:"/idp/auth/me",updateSessionUrl:"/idp/sso/update",authorizeApplicationUrl:"/idp/sso/authorize/application"},this.$get=function(){return this.config}}angular.module("dyn.auth").provider("dynAuthConfig",t),t.$inject=[]}();